doctype html
html
  head
    include ../partials/head.jade
  body
  .header.navbar.navbar-default
    include ../partials/header.jade

  .container-fluid.view-all-imperfections
    .row
      .col-md-4
        h2 All <b>#[a(href='/ideas/'+ idea.name) #{idea.name}]</b> Imperfections
      .col-md-4
      .col-md-4
        .return-button
          a.home-logout.btn.btn-industry.btn-lg( href="/ideas/#{idea.name}") Back to Idea Summary
        br

    .row 
      .idea-summary-data#idea-summary-problems
        each problem, index in problems
          if(problem.text && problem['identifier'])
            include ../partials/problem-summary-element.jade
    input(type="hidden", name="_csrf", value="#{csrfToken}")

  include ../partials/js-includes.jade
  script(src='/exif.js')
  script(type="text/javascript").
    $(".upvote-imperfection").click(function(event){
      event.preventDefault();
      if(!$(this).hasClass("clicked-upvote")){
        $(this).addClass("clicked-upvote");
        $(this).text("Upvote " + (parseInt($(this).text().slice(7)) + 1));
      }

        $.post('/upvote-imperfection', 
        {
          _csrf : $('[name="_csrf"]').val(),
          problem : $(this)[0].dataset['problemId']
        },
        function(data, response) {
        });
      

      return false;
    });
